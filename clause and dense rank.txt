-----clause---------------
SELECT COUNT(2),DEPARTMENT_ID
FROM DBO.S_HREMPLOYEES sh
WHERE DEPARTMENT_ID IS NOT NULL
GROUP BY DEPARTMENT_ID
HAVING COUNT(2)>3
ORDER BY DEPARTMENT_ID desc;
--------dense rank----------
SELECT * FROM (
SELECT DENSE_RANK () OVER (PARTITION BY DEPARTMENT_ID ORDER BY SALARY  DESC) AS DRNK,SALARY,DEPARTMENT_ID
FROM DBO.S_HREMPLOYEES sh 
WHERE DEPARTMENT_ID=90
)X
WHERE DRNK=2
----------rank -------
SELECT * FROM (
SELECT  RANK  () OVER ( PARTITION BY DEPARTMENT_ID ORDER BY HIRE_DATE  ASC ) AS DRNK,SALARY,DEPARTMENT_ID,HIRE_DATE
FROM DBO.S_HREMPLOYEES sh 
WHERE DEPARTMENT_ID=90
)X
WHERE DRNK=3